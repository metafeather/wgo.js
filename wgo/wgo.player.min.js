/*! MIT license, more info: wgo.waltheri.net */(function(c,m){var e=function(b){var d,a;d=b.charCodeAt(0)-97;0>d&&(d+=32);7<d&&d--;a=b.charCodeAt(1)-48;2<b.length&&(a=10*a+(b.charCodeAt(2)-48));a=this.kifuReader.game.size-a;this._tmp_mark={type:"MA",x:d,y:a};this.board.addObject(this._tmp_mark)},g=function(){this.board.removeObject(this._tmp_mark);delete this._tmp_mark},k=function(b,d){for(var a in b)b[a].className&&"wgo-move-link"==b[a].className?(b[a].addEventListener("mouseover",e.bind(d,b[a].innerHTML)),b[a].addEventListener("mouseout",g.bind(d))):
b[a].childNodes&&b[a].childNodes.length&&k(b[a].childNodes,d)},a=function(b,a){var l='<div class="wgo-info-list">';a&&(l+='<div class="wgo-info-title">'+c.t("gameinfo")+"</div>");for(var f in b)l+='<div class="wgo-info-item"><span class="wgo-info-label">'+f+'</span><span class="wgo-info-value">'+b[f]+"</span></div>";return l+"</div>"},l=c.extendClass(c.BasicPlayer.component.Component,function(b){this["super"](b);this.player=b;this.element.className="wgo-commentbox";this.box=document.createElement("div");
this.box.className="wgo-box-wrapper wgo-comments-wrapper";this.element.appendChild(this.box);this.comments_title=document.createElement("div");this.comments_title.className="wgo-box-title";this.comments_title.innerHTML=c.t("comments");this.box.appendChild(this.comments_title);this.comments=document.createElement("div");this.comments.className="wgo-comments-content";this.box.appendChild(this.comments);this.help=document.createElement("div");this.help.className="wgo-help";this.help.style.display="none";
this.comments.appendChild(this.help);this.notification=document.createElement("div");this.notification.className="wgo-notification";this.notification.style.display="none";this.comments.appendChild(this.notification);this.comment_text=document.createElement("div");this.comment_text.className="wgo-comment-text";this.comments.appendChild(this.comment_text);b.addEventListener("kifuLoaded",function(d){d.kifu.hasComments()?(this.comments_title.innerHTML=c.t("comments"),this.element.className="wgo-commentbox",
this._update=function(b){this.setComments(b)}.bind(this),b.addEventListener("update",this._update)):(this.comments_title.innerHTML=c.t("gameinfo"),this.element.className="wgo-commentbox wgo-gameinfo",this._update&&(b.removeEventListener("update",this._update),delete this._update),this.comment_text.innerHTML=a(d.target.getGameInfo()))}.bind(this));b.notification=function(b){b?(this.notification.style.display="block",this.notification.innerHTML=b,this.is_notification=!0):(this.notification.style.display=
"none",this.is_notification=!1)}.bind(this);b.help=function(b){b?(this.help.style.display="block",this.help.innerHTML=b,this.is_help=!0):(this.help.style.display="none",this.is_help=!1)}.bind(this)});l.prototype.setComments=function(b){this.player._tmp_mark&&g.call(this.player);var d="";b.node.parent||(d=a(b.target.getGameInfo(),!0));this.comment_text.innerHTML=d+this.getCommentText(b.node.comment,this.player.config.formatNicks,this.player.config.formatMoves);this.player.config.formatMoves&&this.comment_text.childNodes&&
this.comment_text.childNodes.length&&k(this.comment_text.childNodes,this.player)};l.prototype.getCommentText=function(b,a,l){return b?(b="<p>"+c.filterHTML(b).replace(/\n/g,"</p><p>")+"</p>",a&&(b=b.replace(/(<p>)([^:]{3,}:)\s/g,'<p><span class="wgo-comments-nick">$2</span> ')),l&&(b=b.replace(/\b[a-zA-Z]1?\d\b/g,'<a href="javascript:void(0)" class="wgo-move-link">$&</a>')),b):""};c.BasicPlayer["default"].formatNicks=!0;c.BasicPlayer["default"].formatMoves=!0;c.BasicPlayer.attributes["data-wgo-formatnicks"]=
function(b){"false"==b.toLowerCase()&&(this.formatNicks=!1)};c.BasicPlayer.attributes["data-wgo-formatmoves"]=function(b){"false"==b.toLowerCase()&&(this.formatMoves=!1)};c.BasicPlayer.layouts.right_top.right.push("CommentBox");c.BasicPlayer.layouts.right.right.push("CommentBox");c.BasicPlayer.layouts.one_column.bottom.push("CommentBox");c.i18n.en.comments="Comments";c.i18n.en.gameinfo="Game info";c.BasicPlayer.component.CommentBox=l})(WGo);(function(c,m){var e=function(){this.element=document.createElement("div")};e.prototype={constructor:e,appendTo:function(c){c.appendChild(this.element)},getWidth:function(){var c=window.getComputedStyle(this.element);return parseInt(c.width)},getHeight:function(){var c=window.getComputedStyle(this.element);return parseInt(c.height)},updateDimensions:function(){}};c.BasicPlayer.component.Component=e})(WGo);(function(c,m){var e=c.extendClass(c.BasicPlayer.component.Component,function(b){this["super"](b);this.widgets=[];this.element.className="wgo-player-control";this.iconBar=document.createElement("div");this.iconBar.className="wgo-control-wrapper";this.element.appendChild(this.iconBar);var h,a;for(a in e.widgets)h=new e.widgets[a].constructor(b,e.widgets[a].args),h.appendTo(this.iconBar),this.widgets.push(h)});e.prototype.updateDimensions=function(){this.element.className=340>this.element.clientWidth?
"wgo-player-control wgo-340":440>this.element.clientWidth?"wgo-player-control wgo-440":"wgo-player-control"};var g=c.BasicPlayer.control={},k=function(b){b.node.parent||this.disabled?b.node.parent&&this.disabled&&this.enable():this.disable()},a=function(b){b.node.children.length||this.disabled?b.node.children.length&&this.disabled&&this.enable():this.disable()},l=function(b){(this._disabled=this.disabled)||this.disable()},b=function(b){this._disabled||this.enable();delete this._disabled};g.Widget=
function(b,h){this.element=this.element||document.createElement(h.type||"div");this.element.className="wgo-widget-"+h.name;this.init(b,h)};g.Widget.prototype={constructor:g.Widget,init:function(b,h){h&&(h.disabled&&this.disable(),h.init&&h.init.call(this,b))},appendTo:function(b){b.appendChild(this.element)},disable:function(){this.disabled=!0;-1==this.element.className.search("wgo-disabled")&&(this.element.className+=" wgo-disabled")},enable:function(){this.disabled=!1;this.element.className=this.element.className.replace(" wgo-disabled",
"");this.element.disabled=""}};g.Group=c.extendClass(g.Widget,function(b,h){this.element=document.createElement("div");this.element.className="wgo-ctrlgroup wgo-ctrlgroup-"+h.name;var a,d;for(d in h.widgets)a=new h.widgets[d].constructor(b,h.widgets[d].args),a.appendTo(this.element)});g.Clickable=c.extendClass(g.Widget,function(b,h){this["super"](b,h)});g.Clickable.prototype.init=function(b,h){var a,d=this;a=h.togglable?function(){d.disabled||(h.click.call(d,b)?d.select():d.unselect())}:function(){d.disabled||
h.click.call(d,b)};this.element.addEventListener("click",a);this.element.addEventListener("touchstart",function(b){b.preventDefault();a();h.multiple&&(d._touch_i=0,d._touch_int=window.setInterval(function(){500<d._touch_i&&a();d._touch_i+=100},100));return!1});h.multiple&&this.element.addEventListener("touchend",function(b){window.clearInterval(d._touch_int)});h.disabled&&this.disable();h.init&&h.init.call(this,b)};g.Clickable.prototype.select=function(){this.selected=!0;-1==this.element.className.search("wgo-selected")&&
(this.element.className+=" wgo-selected")};g.Clickable.prototype.unselect=function(){this.selected=!1;this.element.className=this.element.className.replace(" wgo-selected","")};g.Button=c.extendClass(g.Clickable,function(b,h){var a=this.element=document.createElement("button");a.className="wgo-button wgo-button-"+h.name;a.title=c.t(h.name);this.init(b,h)});g.Button.prototype.disable=function(){g.Button.prototype["super"].prototype.disable.call(this);this.element.disabled="disabled"};g.Button.prototype.enable=
function(){g.Button.prototype["super"].prototype.enable.call(this);this.element.disabled=""};g.MenuItem=c.extendClass(g.Clickable,function(b,h){var a=this.element=document.createElement("div");a.className="wgo-menu-item wgo-menu-item-"+h.name;a.title=c.t(h.name);a.innerHTML=a.title;this.init(b,h)});g.MoveNumber=c.extendClass(g.Widget,function(b){this.element=document.createElement("form");this.element.className="wgo-player-mn-wrapper";var a=this.move=document.createElement("input");a.type="text";
a.value="0";a.maxlength=3;a.className="wgo-player-mn-value";this.element.appendChild(a);this.element.onsubmit=a.onchange=function(b){b.goTo(this.getValue());return!1}.bind(this,b);b.addEventListener("update",function(b){this.setValue(b.path.m)}.bind(this));b.addEventListener("kifuLoaded",this.enable.bind(this));b.addEventListener("frozen",this.disable.bind(this));b.addEventListener("unfrozen",this.enable.bind(this))});g.MoveNumber.prototype.disable=function(){g.MoveNumber.prototype["super"].prototype.disable.call(this);
this.move.disabled="disabled"};g.MoveNumber.prototype.enable=function(){g.MoveNumber.prototype["super"].prototype.enable.call(this);this.move.disabled=""};g.MoveNumber.prototype.setValue=function(b){this.move.value=b};g.MoveNumber.prototype.getValue=function(){return parseInt(this.move.value)};var d=function(b){if(b._menu_tmp)delete b._menu_tmp;else{if(!b.menu){b.menu=document.createElement("div");b.menu.className="wgo-player-menu";b.menu.style.position="absolute";b.menu.style.display="none";this.element.parentElement.appendChild(b.menu);
var a,c;for(c in e.menu)a=new e.menu[c].constructor(b,e.menu[c].args,!0),a.appendTo(b.menu)}if("none"!=b.menu.style.display)return b.menu.style.display="none",document.removeEventListener("click",b._menu_ev),delete b._menu_ev,this.unselect(),!1;b.menu.style.display="block";a=this.element.offsetTop;c=this.element.offsetLeft;this.element.parentElement.parentElement.parentElement.parentElement==b.regions.bottom.wrapper?(b.menu.style.left=c+"px",b.menu.style.top=a-b.menu.offsetHeight+1+"px"):(b.menu.style.left=
c+"px",b.menu.style.top=a+this.element.offsetHeight+"px");b._menu_ev=d.bind(this,b);b._menu_tmp=!0;document.addEventListener("click",b._menu_ev);return!0}};e.menu=[{constructor:g.MenuItem,args:{name:"switch-coo",togglable:!0,click:function(b){b.setCoordinates(!b.coordinates);return b.coordinates},init:function(b){b.coordinates&&this.select()}}}];e.widgets=[{constructor:g.Group,args:{name:"left",widgets:[{constructor:g.Button,args:{name:"menu",togglable:!0,click:d}}]}},{constructor:g.Group,args:{name:"right",
widgets:[{constructor:g.Button,args:{name:"about",click:function(b){b.showMessage(c.t("about-text"))}}}]}},{constructor:g.Group,args:{name:"control",widgets:[{constructor:g.Button,args:{name:"first",disabled:!0,init:function(a){a.addEventListener("update",k.bind(this));a.addEventListener("frozen",l.bind(this));a.addEventListener("unfrozen",b.bind(this))},click:function(b){b.first()}}},{constructor:g.Button,args:{name:"multiprev",disabled:!0,multiple:!0,init:function(a){a.addEventListener("update",
k.bind(this));a.addEventListener("frozen",l.bind(this));a.addEventListener("unfrozen",b.bind(this))},click:function(b){var a=c.clone(b.kifuReader.path);a.m-=10;b.goTo(a)}}},{constructor:g.Button,args:{name:"previous",disabled:!0,multiple:!0,init:function(a){a.addEventListener("update",k.bind(this));a.addEventListener("frozen",l.bind(this));a.addEventListener("unfrozen",b.bind(this))},click:function(b){b.previous()}}},{constructor:g.MoveNumber},{constructor:g.Button,args:{name:"next",disabled:!0,multiple:!0,
init:function(d){d.addEventListener("update",a.bind(this));d.addEventListener("frozen",l.bind(this));d.addEventListener("unfrozen",b.bind(this))},click:function(b){b.next()}}},{constructor:g.Button,args:{name:"multinext",disabled:!0,multiple:!0,init:function(d){d.addEventListener("update",a.bind(this));d.addEventListener("frozen",l.bind(this));d.addEventListener("unfrozen",b.bind(this))},click:function(b){var a=c.clone(b.kifuReader.path);a.m+=10;b.goTo(a)}}},{constructor:g.Button,args:{name:"last",
disabled:!0,init:function(d){d.addEventListener("update",a.bind(this));d.addEventListener("frozen",l.bind(this));d.addEventListener("unfrozen",b.bind(this))},click:function(b){b.last()}}}]}}];var n=c.BasicPlayer.layouts;n.right_top.top.push("Control");n.right.right.push("Control");n.one_column.top.push("Control");n.no_comment.bottom.push("Control");n.minimal.bottom.push("Control");var n={about:"About",first:"First",multiprev:"10 moves back",previous:"Previous",next:"Next",multinext:"10 moves forward",
last:"Last","switch-coo":"Display coordinates",menu:"Menu"},f;for(f in n)c.i18n.en[f]=n[f];c.BasicPlayer.component.Control=e})(WGo);(function(){var c=function(b){this[b]={};var a=this[b];a.box=document.createElement("div");a.box.className="wgo-box-wrapper wgo-player-wrapper wgo-"+b;a.name=document.createElement("div");a.name.className="wgo-box-title";a.name.innerHTML=b;a.box.appendChild(a.name);b=document.createElement("div");b.className="wgo-player-info";a.box.appendChild(b);a.info={};a.info.rank=m("rank");a.info.rank.val.innerHTML="-";a.info.caps=m("caps");a.info.caps.val.innerHTML="0";a.info.time=m("time");a.info.time.val.innerHTML=
"--:--";b.appendChild(a.info.rank.wrapper);b.appendChild(a.info.caps.wrapper);b.appendChild(a.info.time.wrapper)},m=function(b){var a={};a.wrapper=document.createElement("div");a.wrapper.className="wgo-player-info-box-wrapper";a.box=document.createElement("div");a.box.className="wgo-player-info-box";a.wrapper.appendChild(a.box);a.title=document.createElement("div");a.title.className="wgo-player-info-title";a.title.innerHTML=WGo.t(b);a.box.appendChild(a.title);a.val=document.createElement("div");a.val.className=
"wgo-player-info-value";a.box.appendChild(a.val);return a},e=function(b){b=b.kifu.info||{};b.black?(this.black.name.innerHTML=WGo.filterHTML(b.black.name)||WGo.t("black"),this.black.info.rank.val.innerHTML=WGo.filterHTML(b.black.rank)||"-"):(this.black.name.innerHTML=WGo.t("black"),this.black.info.rank.val.innerHTML="-");b.white?(this.white.name.innerHTML=WGo.filterHTML(b.white.name)||WGo.t("white"),this.white.info.rank.val.innerHTML=WGo.filterHTML(b.white.rank)||"-"):(this.white.name.innerHTML=WGo.t("white"),
this.white.info.rank.val.innerHTML="-");this.black.info.caps.val.innerHTML="0";this.white.info.caps.val.innerHTML="0";b.TM?(this.setPlayerTime("black",b.TM),this.setPlayerTime("white",b.TM)):(this.black.info.time.val.innerHTML="--:--",this.white.info.time.val.innerHTML="--:--");this.updateDimensions()},g=function(b){var a,c;b.style.fontSize?(c=parseInt(b.style.fontSize),b.style.fontSize="",a=window.getComputedStyle(b),a=parseInt(a.fontSize),b.style.fontSize=c+"px"):(a=window.getComputedStyle(b),a=
c=parseInt(a.fontSize));if(!(c==a&&b.scrollHeight<=b.offsetHeight))if(b.scrollHeight>b.offsetHeight)for(c-=2;b.scrollHeight>b.offsetHeight&&1<c;)b.style.fontSize=c+"px",c-=2;else if(c<a){for(c+=2;b.scrollHeight<=b.offsetHeight&&c<=a;)b.style.fontSize=c+"px",c+=2;b.scrollHeight>b.offsetHeight&&(b.style.fontSize=c-4+"px")}},k=function(b){b.node.BL&&this.setPlayerTime("black",b.node.BL);b.node.WL&&this.setPlayerTime("white",b.node.WL);void 0!==b.position.capCount.black&&(this.black.info.caps.val.innerHTML=
b.position.capCount.black);void 0!==b.position.capCount.white&&(this.white.info.caps.val.innerHTML=b.position.capCount.white)},a=WGo.extendClass(WGo.BasicPlayer.component.Component,function(b){this["super"](b);this.element.className="wgo-infobox";c.call(this,"white");c.call(this,"black");this.element.appendChild(this.white.box);this.element.appendChild(this.black.box);b.addEventListener("kifuLoaded",e.bind(this));b.addEventListener("update",k.bind(this))});a.prototype.setPlayerTime=function(b,a){var c=
Math.round(a)%60;this[b].info.time.val.innerHTML=Math.floor(a/60)+":"+(10>c?"0"+c:c)};a.prototype.updateDimensions=function(){g(this.black.name);g(this.white.name)};var l=WGo.BasicPlayer.layouts;l.right_top.right.push("InfoBox");l.right.right.push("InfoBox");l.one_column.top.push("InfoBox");l.no_comment.top.push("InfoBox");WGo.i18n.en.rank="Rank";WGo.i18n.en.caps="Caps";WGo.i18n.en.time="Time";WGo.BasicPlayer.component.InfoBox=a})(WGo);(function(c){var m=0,e=function(a,c,b){var d={};d.element=document.createElement("div");d.element.className="wgo-player-"+a;d.wrapper=document.createElement("div");d.wrapper.className="wgo-player-"+a+"-wrapper";d.element.appendChild(d.wrapper);c.appendChild(d.element);b||(d.element.style.display="none");return d},g=function(a){var c;if(c=this.currentLayout.layout?this.currentLayout.layout[a]:this.currentLayout[a]){this.regions[a].element.style.display="block";c.constructor!=Array&&(c=[c]);for(var b in c)this.components[c[b]]||
(this.components[c[b]]=new k.component[c[b]](this)),this.components[c[b]].appendTo(this.regions[a].wrapper),this.components[c[b]]._detachFromPlayer=!1}else this.regions[a].element.style.display="none"},k=c.extendClass(c.Player,function(a,l){this.config=l;for(var b in k["default"])void 0===this.config[b]&&void 0!==k["default"][b]&&(this.config[b]=k["default"][b]);for(b in c.Player["default"])void 0===this.config[b]&&void 0!==c.Player["default"][b]&&(this.config[b]=c.Player["default"][b]);this.element=
a;this.element.innerHTML="";this.classes=(this.element.className?this.element.className+" ":"")+"wgo-player-main";this.element.className=this.classes;this.element.id||(this.element.id="wgo_"+m++);this.dom={};this.dom.center=document.createElement("div");this.dom.center.className="wgo-player-center";this.dom.board=document.createElement("div");this.dom.board.className="wgo-player-board";this.regions={};this.regions.left=e("left",this.element);this.element.appendChild(this.dom.center);this.regions.right=
e("right",this.element);this.regions.top=e("top",this.dom.center);this.dom.center.appendChild(this.dom.board);this.regions.bottom=e("bottom",this.dom.center);this.board=new c.Board(this.dom.board,this.config.board);this.init();this.components={};window.addEventListener("resize",function(){this.noresize||this.updateDimensions()}.bind(this));this.updateDimensions();this.initGame()});k.prototype.appendTo=function(a){a.appendChild(this.element);this.updateDimensions()};k.prototype.updateDimensions=function(){for(var a=
window.getComputedStyle(this.element),c=[];this.element.firstChild;)c.push(this.element.firstChild),this.element.removeChild(this.element.firstChild);for(var b=parseInt(a.width),d=parseInt(a.height),n=parseInt(a.maxHeight)||0,a=0;a<c.length;a++)this.element.appendChild(c[a]);if(b!=this.width||d!=this.height||n!=this.maxHeight){this.width=b;this.height=d;this.maxHeight=n;a:if(c=this.config.layout,c.constructor==Array){b=this.height||this.maxHeight;for(d=0;d<c.length;d++)if(!c[d].conditions||!(c[d].conditions.minWidth&&
!(c[d].conditions.minWidth<=this.width)||c[d].conditions.minHeight&&b&&!(c[d].conditions.minHeight<=b)||c[d].conditions.maxWidth&&!(c[d].conditions.maxWidth>=this.width)||c[d].conditions.maxHeight&&b&&!(c[d].conditions.maxHeight>=b)||c[d].conditions.custom&&!c[d].conditions.custom.call(this))){c=c[d];break a}c=void 0}if((this.currentLayout=c)&&this.lastLayout!=this.currentLayout){this.element.className=this.currentLayout.className?this.classes+" "+this.currentLayout.className:this.classes;for(var f in this.components)this.components[f]._detachFromPlayer=
!0;g.call(this,"left");g.call(this,"right");g.call(this,"top");g.call(this,"bottom");for(f in this.components)this.components[f]._detachFromPlayer&&this.components[f].element.parentNode&&this.components[f].element.parentNode.removeChild(this.components[f].element);this.lastLayout=this.currentLayout}c=this.dom.board.clientWidth;(f=this.height||this.maxHeight)&&(f-=this.regions.top.element.offsetHeight+this.regions.bottom.element.offsetHeight);f&&f<c?f!=this.board.height&&this.board.setHeight(f):c!=
this.board.width&&this.board.setWidth(c);c=f-c;0<c?(this.dom.board.style.height=f+"px",this.dom.board.style.paddingTop=c/2+"px"):(this.dom.board.style.height="auto",this.dom.board.style.paddingTop="0");this.regions.left.element.style.height=this.dom.center.offsetHeight+"px";this.regions.right.element.style.height=this.dom.center.offsetHeight+"px";for(a in this.components)this.components[a].updateDimensions&&this.components[a].updateDimensions()}};k.prototype.showMessage=function(a,g,b){this.info_overlay=
document.createElement("div");this.info_overlay.style.width=this.element.offsetWidth+"px";this.info_overlay.style.height=this.element.offsetHeight+"px";this.info_overlay.className="wgo-info-overlay";this.element.appendChild(this.info_overlay);var d=document.createElement("div");d.className="wgo-info-message";d.innerHTML=a;a=document.createElement("div");a.className="wgo-info-close";b||(a.innerHTML=c.t("BP:closemsg"));d.appendChild(a);this.info_overlay.appendChild(d);g?this.info_overlay.addEventListener("click",
function(b){g(b)}):b||this.info_overlay.addEventListener("click",function(b){this.hideMessage()}.bind(this));this.setFrozen(!0)};k.prototype.hideMessage=function(){this.element.removeChild(this.info_overlay);this.setFrozen(!1)};k.prototype.error=function(a){if(!c.ERROR_REPORT)throw a;switch(a.name){case "InvalidMoveError":this.showMessage("<h1>"+a.name+"</h1><p>"+a.message+'</p><p>If this message isn\'t correct, please report it by clicking <a href="#">here</a>, otherwise contact maintainer of this site.</p>');
break;case "FileError":this.showMessage("<h1>"+a.name+"</h1><p>"+a.message+"</p><p>Please contact maintainer of this site. Note: it is possible to read files only from this host.</p>");break;default:this.showMessage("<h1>"+a.name+"</h1><p>"+a.message+"</p><pre>"+a.stacktrace+'</pre><p>Please contact maintainer of this site. You can also report it <a href="#">here</a>.</p>')}};k.component={};k.layouts={one_column:{top:[],bottom:[]},no_comment:{top:[],bottom:[]},right_top:{top:[],right:[]},right:{right:[]},
minimal:{bottom:[]}};k.dynamicLayout=[{conditions:{minWidth:650},layout:k.layouts.right_top,className:"wgo-twocols wgo-large"},{conditions:{minWidth:550,minHeight:600},layout:k.layouts.one_column,className:"wgo-medium"},{conditions:{minWidth:350},layout:k.layouts.no_comment,className:"wgo-small"},{layout:k.layouts.no_comment,className:"wgo-xsmall"}];k["default"]={layout:k.dynamicLayout};c.i18n.en["BP:closemsg"]="click anywhere to close this window";k.attributes={"data-wgo":function(a){a&&("("==a[0]?
this.sgf=a:this.sgfFile=a)},"data-wgo-board":function(a){this.board=eval("({"+a+"})")},"data-wgo-onkifuload":function(a){this.kifuLoaded=new Function(a)},"data-wgo-onupdate":function(a){this.update=new Function(a)},"data-wgo-onfrozen":function(a){this.frozen=new Function(a)},"data-wgo-onunfrozen":function(a){this.unfrozen=new Function(a)},"data-wgo-layout":function(a){this.layout=eval("({"+a+"})")},"data-wgo-enablewheel":function(a){"false"==a.toLowerCase()&&(this.enableWheel=!1)},"data-wgo-lockscroll":function(a){"false"==
a.toLowerCase()&&(this.lockScroll=!1)},"data-wgo-enablekeys":function(a){"false"==a.toLowerCase()&&(this.enableKeys=!1)},"data-wgo-rememberpath":function(a){"false"==a.toLowerCase()&&(this.rememberPath=!1)},"data-wgo-allowillegal":function(a){"false"!=a.toLowerCase()&&(this.allowIllegalMoves=!0)},"data-wgo-move":function(a){var c=parseInt(a);this.move=c?c:eval("({"+a+"})")},"data-wgo-marklastmove":function(a){"false"==a.toLowerCase()&&(this.markLastMove=!1)},"data-wgo-diagram":function(a){a&&("("==
a[0]?this.sgf=a:this.sgfFile=a,this.enableWheel=this.enableKeys=this.markLastMove=!1,this.layout={top:[],right:[],left:[],bottom:[]})}};c.BasicPlayer=k;window.addEventListener("load",function(){for(var a=document.querySelectorAll("[data-wgo],[data-wgo-diagram]"),c=0;c<a.length;c++){for(var b=a[c],d=void 0,g=void 0,d=void 0,g={},f=0;f<b.attributes.length;f++)d=b.attributes[f],k.attributes[d.name]&&k.attributes[d.name].call(g,d.value,d.name);d=new k(b,g);b._wgo_player=d}})})(WGo);(function(c,m){var e=function(b){var a=new p(JSON.parse(JSON.stringify(b.getProperties()))),c;for(c in b.children)a.appendChild(e(b.children[c]));return a},g=function(b,a){var c;if(a[b]!==m)return a[b];for(var h in a.children)if(c=g(b,a.children[h]))return c;return!1},k=function(b,a){b.push(JSON.parse(JSON.stringify(a.getProperties())));if(1<a.children.length){for(var c=[],h=0;h<a.children.length;h++){var d=[];k(d,a.children[h]);c.push(d)}b.push(c)}else a.children.length&&k(b,a.children[0])},a=function(b,
c){for(var h=c,d,f=1;f<b.length;f++)if(b[f].constructor==Array)for(var g=0;g<b[f].length;g++)d=new p(b[f][g][0]),h.appendChild(d),a(b[f][g],d);else d=new p(b[f]),h.insertAfter(d),h=d},l=function(b){return"string"==typeof b?b.replace(/\\/g,"\\\\").replace(/]/g,"\\]"):b},b=function(b,a){return String.fromCharCode(97+b)+String.fromCharCode(97+a)},d=function(b,a,c){if(a.length){c.sgf+=b;for(var h in a)c.sgf+="["+a[h]+"]"}},n=function(a,h){if(a.move){var f="";a.move.pass||(f=b(a.move.x,a.move.y));h.sgf=
a.move.c==c.B?h.sgf+("B["+f+"]"):h.sgf+("W["+f+"]")}if(a.setup){var f=[],g=[],v=[],e;for(e in a.setup)a.setup[e].c==c.B?f.push(b(a.setup[e].x,a.setup[e].y)):a.setup[e].c==c.W?g.push(b(a.setup[e].x,a.setup[e].y)):v.push(b(a.setup[e].x,a.setup[e].y));d("AB",f,h);d("AW",g,h);d("AE",v,h)}if(a.markup){f={};for(e in a.markup)f[a.markup[e].type]=f[a.markup[e].type]||[],"LB"==a.markup[e].type?f.LB.push(b(a.markup[e].x,a.markup[e].y)+":"+l(a.markup[e].text)):f[a.markup[e].type].push(b(a.markup[e].x,a.markup[e].y));
for(var k in f)d(k,f[k],h)}e=a.getProperties();for(k in e)"object"!=typeof e[k]&&(h.sgf="turn"==k?h.sgf+("PL["+(e[k]==c.B?"B":"W")+"]"):"comment"==k?h.sgf+("C["+l(e[k])+"]"):h.sgf+(k+"["+l(e[k])+"]"));if(1==a.children.length)h.sgf+="\n;",n(a.children[0],h);else if(1<a.children.length)for(k in a.children)e=a.children[k],f=h,f.sgf+="(\n;",n(e,f),f.sgf+="\n)"},f=function(){this.size=19;this.info={};this.root=new p;this.propertyCount=this.nodeCount=0};f.prototype={constructor:f,clone:function(){var a=
new f;a.size=this.size;a.info=JSON.parse(JSON.stringify(this.info));a.root=e(this.root);a.nodeCount=this.nodeCount;a.propertyCount=this.propertyCount;return a},hasComments:function(){return!!g("comment",this.root)}};f.fromSgf=function(a){return c.SGF.parse(a)};f.fromJGO=function(b){b="string"==typeof b?JSON.parse(b):b;var c=new f;c.info=JSON.parse(JSON.stringify(b.info));c.size=b.size;c.nodeCount=b.nodeCount;c.propertyCount=b.propertyCount;c.root=new p(b.game[0]);a(b.game,c.root);return c};f.prototype.toSgf=
function(){var a={sgf:"(\n;"},b={},c;for(c in this.info)"black"==c?(this.info.black.name&&(b.PB=l(this.info.black.name)),this.info.black.rank&&(b.BR=l(this.info.black.rank)),this.info.black.team&&(b.BT=l(this.info.black.team))):"white"==c?(this.info.white.name&&(b.PW=l(this.info.white.name)),this.info.white.rank&&(b.WR=l(this.info.white.rank)),this.info.white.team&&(b.WT=l(this.info.white.team))):b[c]=l(this.info[c]);this.size&&(b.SZ=this.size);b.AP||(b.AP="WGo.js:2");b.FF||(b.FF="4");b.GM||(b.GM=
"1");b.CA||(b.CA="UTF-8");for(c in b)b[c]&&(a.sgf+=c+"["+b[c]+"]");n(this.root,a);a.sgf+=")";return a.sgf};f.prototype.toJGO=function(b){var a={};a.size=this.size;a.info=JSON.parse(JSON.stringify(this.info));a.nodeCount=this.nodeCount;a.propertyCount=this.propertyCount;a.game=[];k(a.game,this.root);return b?JSON.stringify(a):a};var q=function(b){var a;b.name?(a=c.filterHTML(b.name),b.rank&&(a+=" ("+c.filterHTML(b.rank)+")"),b.team&&(a+=", "+c.filterHTML(b.team))):(b.team&&(a=c.filterHTML(b.team)),
b.rank&&(a+=" ("+c.filterHTML(b.rank)+")"));return a};f.infoFormatters={black:q,white:q,TM:function(b){if(0==b)return c.t("none");var a,h=Math.floor(b/60);1==h?a="1 "+c.t("minute"):1<h&&(a=h+" "+c.t("minutes"));h=b%60;1==h?a+=" 1 "+c.t("second"):1<h&&(a+=" "+h+" "+c.t("seconds"));return a},RE:function(a){return'<a href="javascript: void(0)" onclick="this.parentNode.innerHTML = \''+c.filterHTML(a)+'\'" title="'+c.t("res-show-tip")+'">'+c.t("show")+"</a>"}};f.infoList="black white AN CP DT EV GN GC HA ON OT RE RO RU SO TM US PC KM".split(" ");
c.Kifu=f;var h=function(a,b,c){for(var h=0;h<a.length;h++)if(a[h].x==b.x&&a[h].y==b.y){a[h][c]=b[c];return}a.push(b)},v=function(a,b){if(a)for(var c=0;c<a.length;c++)if(a[c].x==b.x&&a[c].y==b.y){a.splice(c,1);break}},p=function(a,b){this.parent=b||null;this.children=[];if(a)for(var c in a)this[c]=a[c]};p.prototype={constructor:p,getChild:function(a){a=a||0;return this.children[a]?this.children[a]:null},addSetup:function(a){this.setup=this.setup||[];h(this.setup,a,"c");return this},removeSetup:function(a){v(this.setup,
a);return this},addMarkup:function(a){this.markup=this.markup||[];h(this.markup,a,"type");return this},removeMarkup:function(a){v(this.markup,a);return this},remove:function(){var a=this.parent;if(!a)throw new Exception("Root node cannot be removed");for(var b in a.children)if(a.children[b]==this){a.children.splice(b,1);break}a.children=a.children.concat(this.children);this.parent=null;return a},insertAfter:function(a){for(var b in this.children)this.children[b].parent=a;a.children=a.children.concat(this.children);
a.parent=this;this.children=[a];return a},appendChild:function(a){a.parent=this;this.children.push(a);return a},getProperties:function(){var a={},b;for(b in this)this.hasOwnProperty(b)&&"children"!=b&&"parent"!=b&&"_"!=b[0]&&(a[b]=this[b]);return a}};c.KNode=p;var r=function(a,b){for(var c=a.size,h=[],d=[],f=0;f<c*c;f++)a.schema[f]&&!b.schema[f]?d.push({x:Math.floor(f/c),y:f%c}):a.schema[f]!=b.schema[f]&&h.push({x:Math.floor(f/c),y:f%c,c:b.schema[f]});return{add:h,remove:d}},q=function(a,b,h){this.kifu=
a;this.node=this.kifu.root;this.allow_illegal=h||!1;this.game=new c.Game(this.kifu.size,this.allow_illegal?"NONE":"KO",this.allow_illegal,this.allow_illegal);this.path={m:0};this.kifu.info.HA&&1<this.kifu.info.HA&&(this.game.turn=c.W);this.change=u(this.game,this.node,!0);this.rememberPath=b?!0:!1},w=function(a,b){var c=[],h,d;for(d in a){h=!0;for(var f in b)if(a[d].x==b[f].x&&a[d].y==b[f].y){h=!1;break}h&&c.push(a[d])}return c},u=function(a,b,c){b.parent&&(b.parent._last_selected=b.parent.children.indexOf(b));
if(b.move!=m){if(b.move.pass)return a.pass(b.move.c),{add:[],remove:[]};a=a.play(b.move.x,b.move.y,b.move.c);if("number"==typeof a)throw new x(a,b);for(var h in a)if(a[h].x==b.move.x&&a[h].y==b.move.y)return{add:[],remove:a};return{add:[b.move],remove:a}}c||a.pushPosition();c=[];var d=[];if(b.setup!=m)for(h in b.setup)b.setup[h].c?(a.setStone(b.setup[h].x,b.setup[h].y,b.setup[h].c),c.push(b.setup[h])):(a.removeStone(b.setup[h].x,b.setup[h].y),d.push(b.setup[h]));b.turn&&(a.turn=b.turn);return{add:c,
remove:d}},y=function(a){a===m&&this.rememberPath&&(a=this.node._last_selected);a=a||0;var b=this.node.children[a];if(!b)return!1;var c=u(this.game,b);this.path.m++;1<this.node.children.length&&(this.path[this.path.m]=a);this.node=b;return c},z=function(){if(!this.node.parent)return!1;this.node=this.node.parent;this.game.popPosition();this.node.turn&&(this.game.turn=this.node.turn);this.path[this.path.m]!==m&&delete this.path[this.path.m];this.path.m--;return!0},A=function(){this.game.firstPosition();
this.node=this.kifu.root;this.path={m:0};this.kifu.info.HA&&1<this.kifu.info.HA&&(this.game.turn=c.W);this.change=u(this.game,this.node,!0)};q.prototype={constructor:q,next:function(a){this.change=y.call(this,a);return this},last:function(){var a;for(this.change={add:[],remove:[]};a=y.call(this);){var b=this.change;b.add=w(b.add,a.remove).concat(a.add);b.remove=w(b.remove,a.add).concat(a.remove)}return this},previous:function(){var a=this.game.getPosition();z.call(this);this.change=r(a,this.game.getPosition());
return this},first:function(){var a=this.game.getPosition();A.call(this);this.change=r(a,this.game.getPosition());return this},goTo:function(a){if(a===m)return this;var b=this.game.getPosition();A.call(this);for(var c=0;c<a.m&&y.call(this,a[c+1]);c++);this.change=r(b,this.game.getPosition());return this},previousFork:function(){for(var a=this.game.getPosition();z.call(this)&&1==this.node.children.length;);this.change=r(a,this.game.getPosition());return this},getPosition:function(){return this.game.getPosition()},
allowIllegalMoves:function(a){a?(this.game.allow_rewrite=!0,this.game.allow_suicide=!0,this.repeating="NONE"):(this.game.allow_rewrite=!1,this.game.allow_suicide=!1,this.repeating="KO")}};c.KifuReader=q;var x=function(a,b){this.name="InvalidMoveError";this.message="Invalid move in kifu detected. ";if(b.move&&b.move.c!==m&&b.move.x!==m&&b.move.y!==m){var h=b.move.x;7<b.move.x&&h++;String.fromCharCode(h+65);this.message+="Trying to play "+(b.move.c==c.WHITE?"white":"black")+" move on "+String.fromCharCode(b.move.x+
65)+""+(19-b.move.y)}else this.message+="Move object doesn't contain arbitrary attributes.";if(a)switch(a){case 1:this.message+=", but these coordinates are not on board.";break;case 2:this.message+=", but there already is a stone.";break;case 3:this.message+=", but this move is a suicide.";break;case 4:this.message+=", but this position already occured."}else this.message+="."};x.prototype=Error();x.prototype.constructor=x;c.InvalidMoveError=x;c.i18n.en.show="show";c.i18n.en["res-show-tip"]="Click to show result."})(WGo);(function(c){var m=function(c,e){this.player.frozen||this._lastX==c&&this._lastY==e||(this._lastX=c,this._lastY=e,this._last_mark&&this.board.removeObject(this._last_mark),-1!=c&&-1!=e&&this.player.kifuReader.game.isValid(c,e)?(this._last_mark={type:"outline",x:c,y:e,c:this.player.kifuReader.game.turn},this.board.addObject(this._last_mark)):delete this._last_mark)},e=function(){this._last_mark&&(this.board.removeObject(this._last_mark),delete this._last_mark,delete this._lastX,delete this._lastY)};
c.Player.Editable={};c.Player.Editable=function(c,e){this.player=c;this.board=e;this.editMode=!1};c.Player.Editable.prototype.set=function(g){if(!this.editMode&&g)this.originalReader=this.player.kifuReader,this.player.kifuReader=new c.KifuReader(this.player.kifu.clone(),this.originalReader.rememberPath,this.originalReader.allow_illegal,this.originalReader.allow_illegal),this.player.kifuReader.goTo(this.originalReader.path),this._ev_click=this._ev_click||this.play.bind(this),this._ev_move=this._ev_move||
m.bind(this),this._ev_out=this._ev_out||e.bind(this),this.board.addEventListener("click",this._ev_click),this.board.addEventListener("mousemove",this._ev_move),this.board.addEventListener("mouseout",this._ev_out),this.editMode=!0;else if(this.editMode&&!g){this.originalReader.goTo(this.player.kifuReader.path);g=this.originalReader;for(var k=this.player.kifuReader.getPosition(),a=this.originalReader.getPosition(),l=k.size,b=[],d=[],n=0;n<l*l;n++)k.schema[n]&&!a.schema[n]?d.push({x:Math.floor(n/l),
y:n%l}):k.schema[n]!=a.schema[n]&&b.push({x:Math.floor(n/l),y:n%l,c:a.schema[n]});g.change={add:b,remove:d};this.player.kifuReader=this.originalReader;this.player.update(!0);this.board.removeEventListener("click",this._ev_click);this.board.removeEventListener("mousemove",this._ev_move);this.board.removeEventListener("mouseout",this._ev_out);this.editMode=!1}};c.Player.Editable.prototype.play=function(g,e){!this.player.frozen&&this.player.kifuReader.game.isValid(g,e)&&(this.player.kifuReader.node.appendChild(new c.KNode({move:{x:g,
y:e,c:this.player.kifuReader.game.turn},_edited:!0})),this.player.next(this.player.kifuReader.node.children.length-1))};c.BasicPlayer&&c.BasicPlayer.component.Control&&c.BasicPlayer.component.Control.menu.push({constructor:c.BasicPlayer.control.MenuItem,args:{name:"editmode",togglable:!0,click:function(e){this._editable=this._editable||new c.Player.Editable(e,e.board);this._editable.set(!this._editable.editMode);return this._editable.editMode},init:function(c){var e=this;c.addEventListener("frozen",
function(a){(e._disabled=e.disabled)||e.disable()});c.addEventListener("unfrozen",function(a){e._disabled||e.enable();delete e._disabled})}}});c.i18n.en.editmode="Edit mode"})(WGo);(function(c){var m=function(a,b){this.name="FileError";this.message=1==b?"File '"+a+"' is empty.":2==b?"Network error. It is not possible to read '"+a+"'.":"File '"+a+"' hasn't been found on server."};m.prototype=Error();m.prototype.constructor=m;c.FileError=m;var e=c.loadFromUrl=function(a,b){var c=new XMLHttpRequest;c.onreadystatechange=function(){if(4==c.readyState)if(200==c.status){if(0==c.responseText.length)throw new m(a,1);b(c.responseText)}else throw new m(a);};try{c.open("GET",a,!0),c.send()}catch(d){throw new m(a,
2);}},g=function(a){a.change&&this.board.update(a.change);this.temp_marks&&this.board.removeObject(this.temp_marks);var b=[];this.notification();a.node.move&&this.config.markLastMove&&(a.node.move.pass?this.notification(c.t((a.node.move.c==c.B?"b":"w")+"pass")):b.push({type:"CR",x:a.node.move.x,y:a.node.move.y}));if(1<a.node.children.length&&this.config.displayVariations)for(var d=0;d<a.node.children.length;d++)a.node.children[d].move&&!a.node.children[d].move.pass&&b.push({type:"LB",text:String.fromCharCode(65+
d),x:a.node.children[d].move.x,y:a.node.children[d].move.y,c:this.board.theme.variationColor||"rgba(0,32,128,0.8)"});if(a.node.markup){for(d in a.node.markup)for(var f=0;f<b.length;f++)a.node.markup[d].x==b[f].x&&a.node.markup[d].y==b[f].y&&(b.splice(f,1),f--);b=b.concat(a.node.markup)}this.temp_marks=b;this.board.addObject(b)},k=function(a){this.board.setSize(a.kifu.size);this.board.removeAllObjects();this.config.enableWheel&&this.setWheel(!0)},a=function(b,c){return b==c.element||b==c.element?!1:
b._wgo_scrollable||b.scrollHeight>b.offsetHeight&&"auto"==window.getComputedStyle(b).overflow?!0:a(b.parentNode,c)},l=function(b){var c=b.wheelDelta||-1*b.detail;return a(b.target,this)?!0:0>c?(this.next(),this.config.lockScroll&&b.preventDefault&&b.preventDefault(),!this.config.lockScroll):0<c?(this.previous(),this.config.lockScroll&&b.preventDefault&&b.preventDefault(),!this.config.lockScroll):!0},b=function(a){if(document.querySelector("input:focus, textarea:focus"))return!0;switch(a.keyCode){case 39:this.next();
break;case 37:this.previous();break;default:return!0}this.config.lockScroll&&a.preventDefault&&a.preventDefault();return!this.config.lockScroll},d=function(a,b){if(!this.kifuReader||!this.kifuReader.node)return!1;for(var c in this.kifuReader.node.children)if(this.kifuReader.node.children[c].move&&this.kifuReader.node.children[c].move.x==a&&this.kifuReader.node.children[c].move.y==b){this.next(c);break}},n=function(a){this.config=a;for(var b in n["default"])void 0===this.config[b]&&void 0!==n["default"][b]&&
(this.config[b]=n["default"][b]);this.element=document.createElement("div");this.board=new c.Board(this.element,this.config.board);this.init();this.initGame()};n.prototype={constructor:n,init:function(){this.kifu=null;this.listeners={kifuLoaded:[k.bind(this)],update:[g.bind(this)],frozen:[],unfrozen:[]};this.config.kifuLoaded&&this.addEventListener("kifuLoaded",this.config.kifuLoaded);this.config.update&&this.addEventListener("update",this.config.update);this.config.frozen&&this.addEventListener("frozen",
this.config.frozen);this.config.unfrozen&&this.addEventListener("unfrozen",this.config.unfrozen);this.board.addEventListener("click",d.bind(this));this.element.addEventListener("click",this.focus.bind(this));this.focus()},initGame:function(){this.config.sgf?this.loadSgf(this.config.sgf,this.config.move):this.config.json?this.loadJSON(this.config.json,this.config.move):this.config.sgfFile&&this.loadSgfFromFile(this.config.sgfFile,this.config.move)},update:function(a){this.kifuReader&&this.kifuReader.change&&
(a={type:"update",op:a,target:this,node:this.kifuReader.node,position:this.kifuReader.getPosition(),path:this.kifuReader.path,change:this.kifuReader.change},this.dispatchEvent(a))},loadKifu:function(a,b){this.kifu=a;this.kifuReader=new c.KifuReader(this.kifu,this.config.rememberPath,this.config.allowIllegalMoves);this.dispatchEvent({type:"kifuLoaded",target:this,kifu:this.kifu});this.update("init");b&&this.goTo(b)},loadSgf:function(a,b){try{this.loadKifu(c.Kifu.fromSgf(a),b)}catch(d){this.error(d)}},
loadJSON:function(a,b){try{this.loadKifu(c.Kifu.fromJGO(a),b)}catch(d){this.error(d)}},loadSgfFromFile:function(a,b){var c=this;try{e(a,function(a){c.loadSgf(a,b)})}catch(d){this.error(d)}},addEventListener:function(a,b){this.listeners[a]=this.listeners[a]||[];this.listeners[a].push(b)},removeEventListener:function(a,b){if(this.listeners[a]){var c=this.listeners[a].indexOf(b);-1!=c&&this.listeners[a].splice(c,1)}},dispatchEvent:function(a){if(this.listeners[a.type])for(var b in this.listeners[a.type])this.listeners[a.type][b](a)},
notification:function(a){console&&a&&console.log(a)},help:function(a){console&&console.log(a)},error:function(a){if(!c.ERROR_REPORT)throw a;console&&console.log(a)},next:function(a){if(!this.frozen&&this.kifu)try{this.kifuReader.next(a),this.update()}catch(b){this.error(b)}},previous:function(){if(!this.frozen&&this.kifu)try{this.kifuReader.previous(),this.update()}catch(a){this.error(a)}},last:function(){if(!this.frozen&&this.kifu)try{this.kifuReader.last(),this.update()}catch(a){this.error(a)}},
first:function(){if(!this.frozen&&this.kifu)try{this.kifuReader.first(),this.update()}catch(a){this.error(a)}},goTo:function(a){if(!this.frozen&&this.kifu){var b;"function"==typeof a&&(a=a.call(this));"number"==typeof a?(b=c.clone(this.kifuReader.path),b.m=a||0):b=a;try{this.kifuReader.goTo(b),this.update()}catch(d){this.error(d)}}},getGameInfo:function(){if(!this.kifu)return null;var a={},b;for(b in this.kifu.info)-1!=c.Kifu.infoList.indexOf(b)&&(c.Kifu.infoFormatters[b]?a[c.t(b)]=c.Kifu.infoFormatters[b](this.kifu.info[b]):
a[c.t(b)]=c.filterHTML(this.kifu.info[b]));return a},setFrozen:function(a){this.frozen=a;this.dispatchEvent({type:this.frozen?"frozen":"unfrozen",target:this})},appendTo:function(a){a.appendChild(this.element)},focus:function(){this.config.enableKeys&&this.setKeys(!0)},setKeys:function(a){document.onkeydown=a?b.bind(this):null},setWheel:function(a){!this._wheel_listener&&a?(this._wheel_listener=l.bind(this),a=void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",this.element.addEventListener(a,
this._wheel_listener)):this._wheel_listener&&!a&&(a=void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",this.element.removeEventListener(a,this._wheel_listener),delete this._wheel_listener)},setCoordinates:function(a){!this.coordinates&&a?(this.board.setSection(-.5,-.5,-.5,-.5),this.board.addCustomObject(c.Board.coordinates)):this.coordinates&&!a&&(this.board.setSection(0,0,0,0),this.board.removeCustomObject(c.Board.coordinates));this.coordinates=a}};n["default"]={sgf:void 0,json:void 0,
sgfFile:void 0,move:void 0,board:{},enableWheel:!0,lockScroll:!0,enableKeys:!0,rememberPath:!0,kifuLoaded:void 0,update:void 0,frozen:void 0,unfrozen:void 0,allowIllegalMoves:!1,markLastMove:!0,displayVariations:!0};c.Player=n;var f={"about-text":"<h1>WGo.js Player 2.0</h1><p>WGo.js Player is extension of WGo.js, HTML5 library for purposes of game of go. It allows to replay go game records and it has many features like score counting. It is also designed to be easily extendable.</p><p>WGo.js is open source licensed under <a href='http://en.wikipedia.org/wiki/MIT_License' target='_blank'>MIT license</a>. You can use and modify any code from this project.</p><p>You can find more information at <a href='http://wgo.waltheri.net/player' target='_blank'>wgo.waltheri.net/player</a></p><p>Copyright &copy; 2013 Jan Prokop</p>",
black:"Black",white:"White",DT:"Date",KM:"Komi",HA:"Handicap",AN:"Annotations",CP:"Copyright",GC:"Game comments",GN:"Game name",ON:"Fuseki",OT:"Overtime",TM:"Basic time",RE:"Result",RO:"Round",RU:"Rules",US:"Recorder",PC:"Place",EV:"Event",SO:"Source",none:"none",bpass:"Black passed.",wpass:"White passed."},q;for(q in f)c.i18n.en[q]=f[q]})(WGo);(function(c,m){var e={active:!0,query:{}},g=function(a){try{e.query=JSON.parse('{"'+window.location.hash.substr(1).replace("=",'":')+"}")}catch(c){e.query={}}};window.addEventListener("hashchange",function(){if(""!=window.location.hash&&e.active){g();for(var a in e.query){var c=document.getElementById(a);c&&c._wgo_player&&c._wgo_player.goTo(k)}}});window.addEventListener("DOMContentLoaded",function(){""!=window.location.hash&&e.active&&g()});window.addEventListener("load",function(){if(""!=window.location.hash&&
e.active)for(var a in e.query){var c=document.getElementById(a);if(c&&c._wgo_player){c.scrollIntoView();break}}});var k=function(){if(e.query[this.element.id])return e.query[this.element.id]["goto"]};c.Player["default"].move=k;c.BasicPlayer&&c.BasicPlayer.component.Control&&c.BasicPlayer.component.Control.menu.push({constructor:c.BasicPlayer.control.MenuItem,args:{name:"permalink",click:function(a){var e=location.href.split("#")[0]+"#"+a.element.id+'={"goto":'+JSON.stringify(a.kifuReader.path)+"}";
a.showMessage("<h1>"+c.t("permalink")+'</h1><p><input class="wgo-permalink" type="text" value=\''+e+'\' onclick="this.select(); event.stopPropagation()"/></p>')}}});c.Player.permalink=e;c.i18n.en.permalink="Permanent link"})(WGo);(function(c){var m=function(a,c,b,d){this.originalPosition=a;this.position=a.clone();this.board=c;this.komi=b;this.output=d},e=m.state={UNKNOWN:0,BLACK_STONE:1,WHITE_STONE:-1,BLACK_CANDIDATE:2,WHITE_CANDIDATE:-2,BLACK_NEUTRAL:3,WHITE_NEUTRAL:-3,NEUTRAL:4},g=function(a,c,b,d,e){var f=a.get(c,b);void 0!==f&&f!=d&&f!=e&&(a.set(c,b,d),g(a,c-1,b,d,e),g(a,c,b-1,d,e),g(a,c+1,b,d,e),g(a,c,b+1,d,e))},k=function(a,c,b,d,e){var f=c.get(b,d);a.get(b,d)!=f&&(a.set(b,d,f),k(a,c,b-1,d,e),k(a,c,b,d-1,e),k(a,c,b+
1,d,e),k(a,c,b,d+1,e))};m.prototype.start=function(){this.calculate();this.saved_state=this.board.getState();this.displayScore();this._click=function(a,l){var b=this.originalPosition.get(a,l);b==c.W?this.position.get(a,l)==e.WHITE_STONE?g(this.position,a,l,e.BLACK_CANDIDATE,e.BLACK_STONE):(k(this.position,this.originalPosition,a,l,e.BLACK_STONE),this.calculate()):b==c.B?this.position.get(a,l)==e.BLACK_STONE?g(this.position,a,l,e.WHITE_CANDIDATE,e.WHITE_STONE):(k(this.position,this.originalPosition,
a,l,e.WHITE_STONE),this.calculate()):(b=this.position.get(a,l),b==e.BLACK_CANDIDATE?this.position.set(a,l,e.BLACK_NEUTRAL):b==e.WHITE_CANDIDATE?this.position.set(a,l,e.WHITE_NEUTRAL):b==e.BLACK_NEUTRAL?this.position.set(a,l,e.BLACK_CANDIDATE):b==e.WHITE_NEUTRAL&&this.position.set(a,l,e.WHITE_CANDIDATE));this.board.restoreState({objects:c.clone(this.saved_state.objects)});this.displayScore()}.bind(this);this.board.addEventListener("click",this._click)};m.prototype.end=function(){this.board.restoreState({objects:c.clone(this.saved_state.objects)});
this.board.removeEventListener("click",this._click)};m.prototype.displayScore=function(){for(var a=[],g=[],b=[],d=[],n=[],f=0;f<this.position.size;f++)for(var k=0;k<this.position.size;k++)s=this.position.get(f,k),t=this.originalPosition.get(f,k),s==e.BLACK_CANDIDATE?a.push({x:f,y:k,type:"mini",c:c.B}):s==e.WHITE_CANDIDATE?g.push({x:f,y:k,type:"mini",c:c.W}):s==e.NEUTRAL&&b.push({x:f,y:k}),t==c.W&&s!=e.WHITE_STONE?n.push({x:f,y:k,type:"outline",c:c.W}):t==c.B&&s!=e.BLACK_STONE&&d.push({x:f,y:k,type:"outline",
c:c.B});for(f=0;f<d.length;f++)this.board.removeObjectsAt(d[f].x,d[f].y);for(f=0;f<n.length;f++)this.board.removeObjectsAt(n[f].x,n[f].y);this.board.addObject(n);this.board.addObject(d);this.board.addObject(a);this.board.addObject(g);b="<p style='font-weight: bold;'>"+c.t("RE")+"</p>";f=a.length+n.length+this.originalPosition.capCount.black;k=g.length+d.length+this.originalPosition.capCount.white+parseFloat(this.komi);b+="<p>"+c.t("black")+": "+a.length+" + "+(n.length+this.originalPosition.capCount.black)+
" = "+f+"</br>";b+=c.t("white")+": "+g.length+" + "+(d.length+this.originalPosition.capCount.white)+" + "+this.komi+" = "+k+"</p>";b=f>k?b+("<p style='font-weight: bold;'>"+c.t("bwin",f-k)+"</p>"):b+("<p style='font-weight: bold;'>"+c.t("wwin",k-f)+"</p>");this.output(b)};m.prototype.calculate=function(){var a,c,b,d,g,f;a=this.position;for(f=!0;f;){f=!1;for(var k=0;k<a.size;k++)for(var h=0;h<a.size;h++)if(c=a.get(h,k),c==e.UNKNOWN||c==e.BLACK_CANDIDATE||c==e.WHITE_CANDIDATE){b=[a.get(h-1,k),a.get(h,
k-1),a.get(h+1,k),a.get(h,k+1)];g=d=!1;for(var m=0;4>m;m++)b[m]==e.BLACK_STONE||b[m]==e.BLACK_CANDIDATE?d=!0:b[m]==e.WHITE_STONE||b[m]==e.WHITE_CANDIDATE?g=!0:b[m]==e.NEUTRAL&&(g=d=!0);b=!1;d&&g?b=e.NEUTRAL:d?b=e.BLACK_CANDIDATE:g&&(b=e.WHITE_CANDIDATE);b&&c!=b&&(f=!0,a.set(h,k,b))}}};c.ScoreMode=m;c.BasicPlayer&&c.BasicPlayer.component.Control&&c.BasicPlayer.component.Control.menu.push({constructor:c.BasicPlayer.control.MenuItem,args:{name:"scoremode",togglable:!0,click:function(a){if(this.selected)return a.setFrozen(!1),
this._score_mode.end(),delete this._score_mode,a.notification(),a.help(),!1;a.setFrozen(!0);a.help("<p>"+c.t("help_score")+"</p>");this._score_mode=new c.ScoreMode(a.kifuReader.game.position,a.board,a.kifu.info.KM||.5,a.notification);this._score_mode.start();return!0}}});c.i18n.en.scoremode="Count score";c.i18n.en.score="Score";c.i18n.en.bwin="Black wins by $ points.";c.i18n.en.wwin="White wins by $ points.";c.i18n.en.help_score="Click on stones to mark them dead or alive. You can also set and unset territory points by clicking on them. Territories must be completely bordered."})(WGo);(function(c,m){c.SGF={};var e=function(a,b,c,e,h,g){b=g==b?"black":"white";c.info[b]=c.info[b]||{};c.info[b][a]=h[0]},g=c.SGF.properties={};g.B=g.W=function(a,b,f,e){b.move=!f[0]||19>=a.size&&"tt"==f[0]?{pass:!0,c:"B"==e?c.B:c.W}:{x:f[0].charCodeAt(0)-97,y:f[0].charCodeAt(1)-97,c:"B"==e?c.B:c.W}};g.AB=g.AW=function(a,b,f,e){for(var h in f)b.addSetup({x:f[h].charCodeAt(0)-97,y:f[h].charCodeAt(1)-97,c:"AB"==e?c.B:c.W})};g.AE=function(a,b,c){for(var e in c)b.addSetup({x:c[e].charCodeAt(0)-97,y:c[e].charCodeAt(1)-
97})};g.PL=function(a,b,f){b.turn="b"==f[0]||"B"==f[0]?c.B:c.W};g.C=function(a,b,c){b.comment=c.join()};g.LB=function(a,b,c){for(var e in c)b.addMarkup({x:c[e].charCodeAt(0)-97,y:c[e].charCodeAt(1)-97,type:"LB",text:c[e].substr(3)})};g.CR=g.SQ=g.TR=g.SL=g.MA=function(a,b,c,e){for(var h in c)b.addMarkup({x:c[h].charCodeAt(0)-97,y:c[h].charCodeAt(1)-97,type:e})};g.SZ=function(a,b,c){a.size=parseInt(c[0])};g.BR=g.WR=e.bind(this,"rank","BR");g.PB=g.PW=e.bind(this,"name","PB");g.BT=g.WT=e.bind(this,"team",
"BT");g.TM=function(a,b,c,e){a.info[e]=c[0];b.BL=c[0];b.WL=c[0]};var k=/\(|\)|(;(\s*[A-Z]+(\s*((\[\])|(\[(.|\s)*?([^\\]\]))))+)*)/g,a=/[A-Z]+(\s*((\[\])|(\[(.|\s)*?([^\\]\]))))+/g,l=/[A-Z]+/,b=/(\[\])|(\[(.|\s)*?([^\\]\]))/g;c.SGF.parse=function(d){var e=[],f,g,h,m=new c.Kifu,p=null;d=d.match(k);for(var r in d)if("("==d[r])e.push(p);else if(")"==d[r])p=e.pop();else{p&&m.nodeCount++;p=p?p.appendChild(new c.KNode):m.root;f=d[r].match(a)||[];m.propertyCount+=f.length;for(var w in f){h=l.exec(f[w])[0];
g=f[w].match(b);for(var u in g)g[u]=g[u].substring(1,g[u].length-1).replace(/\\(?!\\)/g,"");if(c.SGF.properties[h])c.SGF.properties[h](m,p,g,h);else 1>=g.length&&(g=g[0]),p.parent?p[h]=g:m.info[h]=g}}return m}})(WGo);
